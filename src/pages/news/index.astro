---
import BaseLayout from "../../layouts/BaseLayout.astro";
import NewsList from "../../components/NewsList.astro";
import NewsNavigation from "../../components/NewsNavigation.astro";
import { getNewsList, getCategories } from "../../repositories/microcmsRepository";

const { contents } = await getNewsList();
const { contents: categories } = await getCategories();

const years = Array.from(
  new Set(contents.map((item) => item.publishedAt?.substring(0, 4)).filter(Boolean))
).sort((a, b) => b.localeCompare(a));
---

<BaseLayout title="お知らせ一覧">
  <section>
    <h2>お知らせ一覧</h2>
    <NewsList items={contents} />
  </section>
  <NewsNavigation years={years} categories={categories} />
</BaseLayout>
